<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<script src="../env.js" type="text/javascript"></script>
<script src="../net/utils.js" type="text/javascript"></script>
<script>
enablePrivilege("UniversalXPConnect");

var prefOrigValue = Firebug.getPref(prefDomain, "showXMLHttpRequests");
Firebug.setPref(prefDomain, "showXMLHttpRequests", true);

makeRequest("GET", "issue1307.txt", function(request) 
{
    enablePrivilege("UniversalXPConnect");
    FBTrace.sysout("fireunit.issue1307.check console panel for existence of XHR", request);

    Firebug.showBar(true);
    FirebugChrome.selectPanel("console");

    var panelNode = fireunit.panel("console");
    expandNetRows(panelNode, "spyTitleCol", "spyCol");
    expandNetTabs(panelNode, "netInfoResponseTab");

    var responseBody = FBL.getElementByClass(panelNode, "netInfoResponseText", "netInfoText");
    fireunit.ok(responseBody, "Response tab must exist.");
    if (responseBody) {
        if (responseBody.firstChild.firstChild) {
            fireunit.compare("Response for Issue1307.html", 
                responseBody.textContent, "Test response must match.");
        }
    }

    // Finish test
    Firebug.setPref(prefDomain, "showXMLHttpRequests", prefOrigValue);
    FBTrace.sysout("fireunit.issue1307.DONE");
    fireunit.testDone();
});
</script>
</head>
<body>
<h1>Test for Issue #1307</h1>
</body>
</html>
